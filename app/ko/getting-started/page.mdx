---
title: 시작하기
description: 런타임 설치와 세그먼트별 하이드레이션 활성화 방법
---

# 시작하기

두 단계를 따라 next-nexus를 완전히 활성화하세요. 마지막에 체크리스트로 검증합니다.

## 1) 전역 클라이언트 런타임 설치(1회)

루트 레이아웃에 한 번만 설치해 클라이언트 캐시를 초기화하고, RSC 요청에 클라이언트 캐시 메타데이터를 포함합니다.

```tsx path=null start=null
// app/layout.tsx
import { NexusRuntime } from "next-nexus/client";

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="ko">
      <body>
        {children}
        {/* 전역 1회만 설치하세요. 중첩 레이아웃에 두지 마세요. */}
        <NexusRuntime />
      </body>
    </html>
  );
}
```

참고

- 전역 1회 설치. 여러 번 설치하면 불필요한 작업이 발생합니다.
- `</body>` 근처에 두어 페이지 트리 마운트 이후 초기화되도록 합니다.

## 2) 데이터 페칭 세그먼트에 하이드레이션 활성화

데이터를 가져오는 세그먼트를 하이드레이션 경계로 감싸 서버 데이터를 클라이언트로 전달합니다.

옵션 A — 세그먼트 레이아웃에 경계 적용(동일 세그먼트에 여러 페이지가 있을 때 권장)

```tsx path=null start=null
// app/(shop)/products/layout.tsx
import { NexusHydrationBoundary } from "next-nexus/server";

export default function ProductsLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return <NexusHydrationBoundary>{children}</NexusHydrationBoundary>;
}
```

옵션 B — 페이지 HOC 사용(해당 세그먼트에 별도 레이아웃이 필요 없을 때)

```tsx path=null start=null
// app/(shop)/products/page.tsx
import { withNexusHydrationBoundary, nexus } from "next-nexus/server";
import { productDefinition } from "@/api/productDefinition";

async function ProductsPage() {
  const { data: products, headers } = await nexus(productDefinition.list);
  const total = headers.get("x-total-count");
  return (
    <div>
      <h1>상품 목록 ({total ?? "n/a"})</h1>
      <ul>
        {products?.map((p) => (
          <li key={p.id}>{p.name}</li>
        ))}
      </ul>
    </div>
  );
}

export default withNexusHydrationBoundary(ProductsPage);
```

결정 가이드

- 동일 세그먼트에 여러 페이지가 데이터를 가져오면 레이아웃 경계를 사용하세요.
- 단일 페이지만 데이터를 가져오면 HOC가 보일러플레이트를 줄입니다.

## 검증 체크리스트

- 루트 레이아웃에 <NexusRuntime />가 정확히 1회 설치됨
- 하나의 렌더 경로에는 레이아웃 경계 또는 페이지 HOC 중 하나만 적용됨(중복 금지)
- 서버 코드는 "next-nexus/server", 클라이언트 코드는 "next-nexus/client"에서 임포트
- 모든 definition은 공통 팩토리(createNexusDefinition)로 만들고, 제네릭 응답 타입을 명시

## 다음 단계

- 요청 정의: [Definitions](/ko/api/definitions)
- 서버에서 가져오기: [nexus](/ko/api/nexus)
- 클라이언트에서 조회: [useNexusQuery](/ko/api/hooks/use-nexus-query)
