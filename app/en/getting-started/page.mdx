---
title: Getting Started
description: Setup next-nexus runtime and enable hydration per segment
---

# Getting Started

Follow two steps to enable next-nexus end to end, then verify with the checklist.

## 1) Install the global client runtime (once)

Add the runtime once in your root layout to initialize the client cache and send client cache metadata with RSC requests.

```tsx path=null start=null
// app/layout.tsx
import { NexusRuntime } from 'next-nexus/client';

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body>
        {children}
        {/* Install once globally. Do not put this in nested layouts. */}
        <NexusRuntime />
      </body>
    </html>
  );
}
```

Notes
- Install exactly once globally. Multiple installations cause duplicate work.
- Keep it near `</body>` so it mounts after your page tree.

## 2) Enable hydration in data‑fetching segments

Wrap the segment that fetches data with a hydration boundary — either at the segment layout or with a page‑level HOC.

Option A — Segment layout boundary (recommended for segments with multiple pages)
```tsx path=null start=null
// app/(shop)/products/layout.tsx
import { NexusHydrationBoundary } from 'next-nexus/server';

export default function ProductsLayout({ children }: { children: React.ReactNode }) {
  return <NexusHydrationBoundary>{children}</NexusHydrationBoundary>;
}
```

Option B — Page‑level HOC (when the segment doesn’t need its own layout)
```tsx path=null start=null
// app/(shop)/products/page.tsx
import { withNexusHydrationBoundary, nexus } from 'next-nexus/server';
import { productDefinition } from '@/api/productDefinition';

async function ProductsPage() {
  const { data: products, headers } = await nexus(productDefinition.list);
  const total = headers.get('x-total-count');
  return (
    <div>
      <h1>Products ({total ?? 'n/a'})</h1>
      <ul>{products?.map(p => <li key={p.id}>{p.name}</li>)}</ul>
    </div>
  );
}

export default withNexusHydrationBoundary(ProductsPage);
```

Decision guide
- Use a layout boundary when several sibling pages under the same segment fetch data.
- Use the page HOC when only a single page fetches data and a new layout would be boilerplate.

## Validation checklist
- Root layout contains exactly one <NexusRuntime />.
- Exactly one hydration boundary applies to a given rendered page: either segment layout OR page HOC, not both.
- Server code imports from "next-nexus/server"; client code imports from "next-nexus/client".
- Definition objects are created via a shared factory (createNexusDefinition) and include explicit generic response types.

## Next steps
- Define requests: see [Definitions](/en/api/definitions)
- Fetch on the server: see [nexus](/en/api/nexus)
- Query on the client: see [useNexusQuery](/en/api/hooks/use-nexus-query)
